{"version":"v1.0","name":"build-check","description":"Build application and run unit-tests","jobs":[{"job":"checkout-build-test","steps":[{"checkout":"{{.cds.workspace}}"},{"name":"Composer","script":["#!/bin/bash","php -d memory_limit=-1 /usr/bin/composer update","php -d memory_limit=-1 /usr/bin/composer require --dev phpunit/phpunit pdepend/pdepend"]},{"name":"Create reports dir","script":["mkdir reports"]},{"name":"Unit-tests","script":["#!/bin/bash","php -d memory_limit=-1 {{.cds.workspace}}/vendor/bin/phpunit --log-junit reports/web-phpunit.xml --coverage-clover reports/web-clover.xml --coverage-html reports/web-coverage","php -d memory_limit=-1 {{.cds.workspace}}/vendor/bin/pdepend --jdepend-xml=reports/jdepend.xml src"]},{"jUnitReport":"reports/web-phpunit.xml"},{"coverage":{"format":"clover","path":"reports/web-clover.xml"}},{"SonarScanner":{"sonar-project.properties":"sonar.projectKey={{.cds.application}}\nsonar.projectName={{.cds.application}}\nsonar.projectVersion={{.git.hash}}\nsonar.sources=src\nsonar.exclusions=**/*_test.go,**/vendor/**\nsonar.tests=tests\nsonar.test.inclusions=**/*_test.go\nsonar.test.exclusions=**/vendor/**\nsonar.sourceEncoding=UTF-8\nsonar.php.coverage.reportPaths=reports/web-clover.xml\nsonar.php.tests.reportPath=reports/web-phpunit.xml","sonarDownloadURL":"https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-{{.sonarVersion}}-linux.zip","sonarPassword":"{{.cds.proj.sonarPassword}}","sonarURL":"{{.cds.proj.sonarURL}}","sonarUsername":"{{.cds.proj.sonarUsername}}","sonarVersion":"4.3.0.2102","workspace":"{{.cds.workspace}}"}}],"requirements":[{"binary":"bash","service":{}},{"binary":"composer","service":{}},{"binary":"curl","service":{}},{"binary":"git","service":{}},{"binary":"java","service":{}},{"binary":"unzip","service":{}}]}]}
