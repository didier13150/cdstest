{"version":"v1.0","name":"pipeline","jobs":[{"job":"integration","steps":[{"checkout":"{{.cds.workspace}}"},{"name":"Run composer update","script":["php -d memory_limit=-1 /usr/bin/composer update"]},{"name":"Run composer to add ci tools","script":["php -d memory_limit=-1 /usr/bin/composer require --dev phpunit/phpunit pdepend/pdepend"]},{"name":"Create reports dir","script":["mkdir reports"]},{"name":"Run phpunit","script":["php -d memory_limit=-1 {{.cds.workspace}}/vendor/bin/phpunit --log-junit reports/web-phpunit.xml --coverage-clover reports/web-clover.xml --coverage-html reports/web-coverage"]},{"name":"Run pdepend","script":["php -d memory_limit=-1 {{.cds.workspace}}/vendor/bin/pdepend --jdepend-xml=reports/jdepend.xml src"]},{"jUnitReport":"{{.cds.workspace}}/reports/web-phpunit.xml"},{"coverage":{"format":"clover","path":"{{.cds.workspace}}/reports/web-clover.xml"}},{"serveStaticFiles":{"name":"Coverage","path":"{{.cds.workspace}}/reports/web-coverage"}},{"name":"Install sonnar-scanner","script":["curl -fsSL https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-${SONNAR_SCANNER_VERSION}.zip -o /tmp/sonar-scanner-cli-${SONNAR_SCANNER_VERSION}.zip \u0026\u0026 pushd /opt \u0026\u0026 unzip /tmp/sonar-scanner-cli-${SONNAR_SCANNER_VERSION}.zip \u0026\u0026 mv sonar-scanner-${SONNAR_SCANNER_VERSION} sonar-scanner \u0026\u0026 popd \u0026\u0026 rm -rf /tmp/sonar-scanner-cli-${SONNAR_SCANNER_VERSION}.zip"]},{"name":"SonarScanner","script":["/opt/sonar-scanner/bin/sonar-scanner -Dsonar.sources=src -Dsonar.host.url=https://sonar.tartarefr.eu"]}],"requirements":[{"binary":"bash","service":{}},{"binary":"composer","service":{}},{"binary":"git","service":{}}]}]}